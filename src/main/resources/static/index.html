<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word2PDF è½¬æ¢æœåŠ¡ - è´¨é‡éªŒè¯ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .tabs {
            display: flex;
            border-bottom: 2px solid #f0f0f0;
            margin-bottom: 30px;
        }

        .tab {
            padding: 15px 30px;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 1rem;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: #4facfe;
            border-bottom-color: #4facfe;
            background: rgba(79, 172, 254, 0.1);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .upload-section {
            background: #f8f9fa;
            border: 2px dashed #ddd;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        .upload-section:hover {
            border-color: #4facfe;
            background: rgba(79, 172, 254, 0.05);
        }

        .file-input {
            margin: 20px 0;
        }

        .file-input input {
            margin-bottom: 10px;
        }

        .converter-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }

        .converter-btn {
            padding: 15px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .converter-btn:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.6s ease;
        }

        .converter-btn:hover:before {
            width: 300px;
            height: 300px;
        }

        .poi-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .docx4j-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .libreoffice-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .jodconverter-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            color: white;
        }

        .quality-btn {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        .compare-btn {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
            grid-column: 1 / -1;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 6px solid #f3f3f3;
            border-top: 6px solid #4facfe;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result {
            margin-top: 30px;
            padding: 25px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
            display: none;
        }

        .result.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .result.error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .quality-result {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .quality-score {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .score-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            color: white;
        }

        .score-excellent { background: #28a745; }
        .score-good { background: #17a2b8; }
        .score-average { background: #ffc107; color: #212529; }
        .score-poor { background: #dc3545; }

        .quality-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .detail-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .detail-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4facfe;
        }

        .detail-label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        .ranking-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .ranking-table th,
        .ranking-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .ranking-table th {
            background: #f8f9fa;
            font-weight: 600;
        }

        .ranking-table tr:hover {
            background: rgba(79, 172, 254, 0.05);
        }

        .available-converters {
            background: #e7f3ff;
            border: 1px solid #b8daff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .available-converters h3 {
            color: #004085;
            margin-bottom: 10px;
        }

        .converter-list {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .converter-tag {
            background: #4facfe;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”„ Word2PDF è½¬æ¢æœåŠ¡</h1>
            <p>é«˜è´¨é‡Wordæ–‡æ¡£è½¬PDFå·¥å…· - æ”¯æŒJODConverterä¼ä¸šçº§è½¬æ¢ã€å¯¹è±¡å­˜å‚¨ã€ä¸‹è½½é“¾æ¥ç”Ÿæˆã€è´¨é‡éªŒè¯ä¸å¯¹æ¯”åˆ†æ</p>
        </div>

        <div class="content">
            <!-- å¯ç”¨è½¬æ¢å™¨æ˜¾ç¤º -->
            <div class="available-converters">
                <h3>ğŸ”§ å¯ç”¨è½¬æ¢å™¨</h3>
                <div class="converter-list" id="converterList">
                    <span class="converter-tag">åŠ è½½ä¸­...</span>
                </div>
            </div>

            <!-- æ ‡ç­¾å¯¼èˆª -->
            <div class="tabs">
                <button class="tab active" onclick="switchTab('convert')">è½¬æ¢æ–‡æ¡£</button>
                <button class="tab" onclick="switchTab('jodconverter')">JODConverter</button>
                <button class="tab" onclick="switchTab('validate')">è´¨é‡éªŒè¯</button>
                <button class="tab" onclick="switchTab('compare')">è´¨é‡å¯¹æ¯”</button>
            </div>

            <!-- è½¬æ¢æ–‡æ¡£æ ‡ç­¾ -->
            <div id="convert" class="tab-content active">
                <div class="upload-section">
                    <h3>ğŸ“„ é€‰æ‹©Wordæ–‡æ¡£</h3>
                    <p>æ”¯æŒ .docx å’Œ .doc æ ¼å¼</p>
                    <div class="file-input">
                        <input type="file" id="fileInput" accept=".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document">
                    </div>
                </div>

                <div class="converter-buttons">
                    <button class="converter-btn poi-btn" onclick="convertAndValidate('POI')">
                        <strong>POI è½¬æ¢å™¨</strong><br>
                        <small>ä¼˜åŒ–ä¸­æ–‡æ”¯æŒ</small>
                    </button>
                    <button class="converter-btn docx4j-btn" onclick="convertAndValidate('Docx4j')">
                        <strong>Docx4j è½¬æ¢å™¨</strong><br>
                        <small>ä¼ä¸šçº§æ–¹æ¡ˆ</small>
                    </button>
                    <button class="converter-btn libreoffice-btn" onclick="convertAndValidate('LibreOffice')">
                        <strong>LibreOffice è½¬æ¢å™¨</strong><br>
                        <small>ä¸“ä¸šçº§è´¨é‡</small>
                    </button>
                    <button class="converter-btn jodconverter-btn" onclick="convertWithJODConverter()">
                        <strong>JODConverter è½¬æ¢å™¨</strong><br>
                        <small>ğŸš€ é«˜æ€§èƒ½ä¼ä¸šçº§</small>
                    </button>
                    <button class="converter-btn compare-btn" onclick="batchQualityComparison()">
                        <strong>ğŸ† è´¨é‡å¯¹æ¯”åˆ†æ</strong><br>
                        <small>ä½¿ç”¨æ‰€æœ‰è½¬æ¢å™¨å¹¶åˆ†æè´¨é‡å·®å¼‚</small>
                    </button>
                </div>
            </div>

            <!-- JODConverter ä¸“ç”¨æ ‡ç­¾ -->
            <div id="jodconverter" class="tab-content">
                <div class="upload-section">
                    <h3>ğŸš€ JODConverter é«˜æ€§èƒ½è½¬æ¢</h3>
                    <p>åŸºäº LibreOffice UNO API çš„ä¼ä¸šçº§è½¬æ¢è§£å†³æ–¹æ¡ˆ</p>
                    <div class="file-input">
                        <input type="file" id="jodFileInput" accept=".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document">
                    </div>
                </div>

                <!-- JODConverter çŠ¶æ€æ£€æŸ¥ -->
                <div class="available-converters" style="margin-bottom: 20px;">
                    <h3>ğŸ“Š JODConverter çŠ¶æ€</h3>
                    <div id="jodStatus" style="padding: 10px;">
                        <button class="converter-btn" onclick="checkJODConverterStatus()" style="background: #17a2b8; margin-right: 10px;">
                            ğŸ” æ£€æŸ¥çŠ¶æ€
                        </button>
                        <button class="converter-btn" onclick="checkJODConverterHealth()" style="background: #28a745;">
                            â¤ï¸ å¥åº·æ£€æŸ¥
                        </button>
                    </div>
                    <div id="jodStatusResult" style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 8px; display: none;">
                        <!-- çŠ¶æ€ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                    </div>
                </div>

                <!-- JODConverter è½¬æ¢æŒ‰é’® -->
                <div class="converter-buttons">
                    <button class="converter-btn jodconverter-btn" onclick="convertWithJODConverter()">
                        <strong>ğŸš€ JODConverter è½¬æ¢</strong><br>
                        <small>é«˜æ€§èƒ½ + è¿›ç¨‹æ± ç®¡ç†</small>
                    </button>
                    <button class="converter-btn quality-btn" onclick="convertAndValidateJOD()">
                        <strong>ğŸ” è½¬æ¢ + è´¨é‡éªŒè¯</strong><br>
                        <small>ä¸€ç«™å¼è½¬æ¢å’Œè´¨é‡åˆ†æ</small>
                    </button>
                    <button class="converter-btn" onclick="convertToStorage()" style="background: linear-gradient(135deg, #fd79a8 0%, #fdcb6e 100%); color: white;">
                        <strong>â˜ï¸ è½¬æ¢åˆ°å¯¹è±¡å­˜å‚¨</strong><br>
                        <small>è½¬æ¢å¹¶ä¸Šä¼ åˆ°å­˜å‚¨ï¼Œè¿”å›ä¸‹è½½é“¾æ¥</small>
                    </button>
                </div>

                <!-- JODConverter ç‰¹æ€§è¯´æ˜ -->
                <div style="margin-top: 30px; padding: 20px; background: #e7f3ff; border-radius: 10px;">
                    <h4>ğŸŒŸ JODConverter ç‰¹æ€§</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <strong>âš¡ é«˜æ€§èƒ½</strong><br>
                            <small>åŸºäº LibreOffice UNO API</small>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <strong>ğŸ”„ è¿›ç¨‹æ± </strong><br>
                            <small>è‡ªåŠ¨ç®¡ç†å¤šä¸ª LibreOffice è¿›ç¨‹</small>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <strong>ğŸ¢ ä¼ä¸šçº§</strong><br>
                            <small>é€‚åˆé«˜å¹¶å‘ç”Ÿäº§ç¯å¢ƒ</small>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <strong>ğŸŒ ä¸­æ–‡æ”¯æŒ</strong><br>
                            <small>åŸç”Ÿæ”¯æŒä¸­æ–‡æ–‡æ¡£</small>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <strong>â˜ï¸ å¯¹è±¡å­˜å‚¨</strong><br>
                            <small>æ”¯æŒè½¬æ¢åä¸Šä¼ åˆ°å­˜å‚¨</small>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <strong>ğŸ”— ä¸‹è½½é“¾æ¥</strong><br>
                            <small>è‡ªåŠ¨ç”Ÿæˆæ°¸ä¹…å’Œé¢„ç­¾åé“¾æ¥</small>
                        </div>
                    </div>
                </div>

                <!-- å¿«é€Ÿæµ‹è¯•åŒºåŸŸ -->
                <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 10px;">
                    <h4>ğŸ§ª å¿«é€Ÿæµ‹è¯• API æ¥å£</h4>
                    <p style="color: #856404; margin-bottom: 15px;">æµ‹è¯• JODConverter çš„å„ä¸ªæ¥å£åŠŸèƒ½</p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #ffeaa7;">
                            <strong>ğŸ“¡ API ç«¯ç‚¹æµ‹è¯•</strong><br>
                            <button onclick="testJODConverterEndpoints()" style="margin-top: 10px; padding: 8px 16px; background: #6c5ce7; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æµ‹è¯•æ‰€æœ‰ç«¯ç‚¹
                            </button>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #ffeaa7;">
                            <strong>â±ï¸ æ€§èƒ½æµ‹è¯•</strong><br>
                            <button onclick="performanceTest()" style="margin-top: 10px; padding: 8px 16px; background: #a29bfe; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æ€§èƒ½åŸºå‡†æµ‹è¯•
                            </button>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #ffeaa7;">
                            <strong>ğŸ“Š ç›‘æ§ä¿¡æ¯</strong><br>
                            <button onclick="showJODConverterInfo()" style="margin-top: 10px; padding: 8px 16px; background: #fd79a8; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
                            </button>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #ffeaa7;">
                            <strong>â˜ï¸ å¯¹è±¡å­˜å‚¨æµ‹è¯•</strong><br>
                            <button onclick="testStorageConversion()" style="margin-top: 10px; padding: 8px 16px; background: #fd79a8; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æµ‹è¯•å­˜å‚¨è½¬æ¢
                            </button>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #ffeaa7;">
                            <strong>ğŸ”— ä¸‹è½½é“¾æ¥æµ‹è¯•</strong><br>
                            <button onclick="testDownloadLinks()" style="margin-top: 10px; padding: 8px 16px; background: #00b894; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                éªŒè¯ä¸‹è½½é“¾æ¥
                            </button>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #ffeaa7;">
                            <strong>ğŸ“ å­˜å‚¨çŠ¶æ€æŸ¥çœ‹</strong><br>
                            <button onclick="showStorageInfo()" style="margin-top: 10px; padding: 8px 16px; background: #e17055; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æŸ¥çœ‹å­˜å‚¨ä¿¡æ¯
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- è´¨é‡éªŒè¯æ ‡ç­¾ -->
            <div id="validate" class="tab-content">
                <div class="upload-section">
                    <h3>ğŸ” ä¸Šä¼ æ–‡ä»¶è¿›è¡Œè´¨é‡éªŒè¯</h3>
                    <div class="file-input">
                        <label>åŸå§‹Wordæ–‡æ¡£ï¼š</label>
                        <input type="file" id="wordFileInput" accept=".doc,.docx" style="margin-bottom: 15px;">
                        <br>
                        <label>ç”Ÿæˆçš„PDFæ–‡ä»¶ï¼š</label>
                        <input type="file" id="pdfFileInput" accept=".pdf">
                        <br>
                        <label>è½¬æ¢å™¨åç§°ï¼š</label>
                        <select id="converterSelect" style="margin-top: 10px; padding: 8px;">
                            <option value="POI">POI</option>
                            <option value="Docx4j">Docx4j</option>
                            <option value="LibreOffice">LibreOffice</option>
                            <option value="JODConverter">JODConverter</option>
                        </select>
                    </div>
                    <button class="converter-btn quality-btn" onclick="validateQuality()">
                        <strong>ğŸ” å¼€å§‹è´¨é‡éªŒè¯</strong>
                    </button>
                </div>
            </div>

            <!-- è´¨é‡å¯¹æ¯”æ ‡ç­¾ -->
            <div id="compare" class="tab-content">
                <div class="upload-section">
                    <h3>ğŸ“Š æ‰¹é‡è´¨é‡å¯¹æ¯”åˆ†æ</h3>
                    <p>ä¸Šä¼ Wordæ–‡æ¡£ï¼Œç³»ç»Ÿå°†ä½¿ç”¨æ‰€æœ‰å¯ç”¨è½¬æ¢å™¨è¿›è¡Œè½¬æ¢å¹¶åˆ†æè´¨é‡å·®å¼‚</p>
                    <div class="file-input">
                        <input type="file" id="compareFileInput" accept=".doc,.docx">
                    </div>
                    <button class="converter-btn compare-btn" onclick="batchQualityComparison()">
                        <strong>ğŸš€ å¼€å§‹æ‰¹é‡å¯¹æ¯”</strong>
                    </button>
                </div>
            </div>

            <!-- åŠ è½½æç¤º -->
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>æ­£åœ¨å¤„ç†ä¸­ï¼Œè¯·ç¨å€™...</p>
            </div>

            <!-- ç»“æœæ˜¾ç¤º -->
            <div id="result" class="result"></div>
        </div>
    </div>

    <script>
        // é¡µé¢åŠ è½½æ—¶è·å–å¯ç”¨è½¬æ¢å™¨
        window.addEventListener('load', function() {
            loadAvailableConverters();
        });

        // åŠ è½½å¯ç”¨è½¬æ¢å™¨
        function loadAvailableConverters() {
            fetch('/api/convert/converters')
                .then(response => response.json())
                .then(converters => {
                    const converterList = document.getElementById('converterList');
                    converterList.innerHTML = '';
                    converters.forEach(converter => {
                        const tag = document.createElement('span');
                        tag.className = 'converter-tag';
                        tag.textContent = converter;
                        converterList.appendChild(tag);
                    });
                })
                .catch(error => {
                    console.error('Failed to load converters:', error);
                    document.getElementById('converterList').innerHTML = 
                        '<span class="converter-tag" style="background: #dc3545;">åŠ è½½å¤±è´¥</span>';
                });
        }

        // åˆ‡æ¢æ ‡ç­¾
        function switchTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾çš„æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾å†…å®¹
            document.getElementById(tabName).classList.add('active');
            
            // æ¿€æ´»é€‰ä¸­çš„æ ‡ç­¾
            event.target.classList.add('active');
        }

        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        function showLoading() {
            document.getElementById('loading').classList.add('show');
            document.getElementById('result').style.display = 'none';
        }

        // éšè—åŠ è½½çŠ¶æ€
        function hideLoading() {
            document.getElementById('loading').classList.remove('show');
        }

        // æ˜¾ç¤ºç»“æœ
        function showResult(data, isSuccess = true) {
            const resultDiv = document.getElementById('result');
            
            if (data.validation) {
                // æ˜¾ç¤ºè´¨é‡éªŒè¯ç»“æœ
                showQualityResult(data);
            } else if (data.ranking) {
                // æ˜¾ç¤ºæ‰¹é‡å¯¹æ¯”ç»“æœ
                showComparisonResult(data);
            } else if (data.downloadUrl || data.objectKey) {
                // æ˜¾ç¤ºå¯¹è±¡å­˜å‚¨ç»“æœ
                showStorageResult(data);
            } else {
                // æ˜¾ç¤ºæ™®é€šè½¬æ¢ç»“æœ
                resultDiv.textContent = JSON.stringify(data, null, 2);
                resultDiv.className = `result ${isSuccess ? 'success' : 'error'}`;
                resultDiv.style.display = 'block';
            }
            
            hideLoading();
        }

        // æ˜¾ç¤ºè´¨é‡éªŒè¯ç»“æœ
        function showQualityResult(data) {
            const resultDiv = document.getElementById('result');
            const validation = data.validation;
            
            let scoreClass = 'score-poor';
            if (validation.overallScore >= 0.9) scoreClass = 'score-excellent';
            else if (validation.overallScore >= 0.8) scoreClass = 'score-good';
            else if (validation.overallScore >= 0.7) scoreClass = 'score-average';
            
            const html = `
                <div class="quality-result">
                    <h3>ğŸ¯ è´¨é‡éªŒè¯ç»“æœ - ${validation.converterName}</h3>
                    
                    <div class="quality-score">
                        <div class="score-circle ${scoreClass}">
                            ${Math.round(validation.overallScore * 100)}
                        </div>
                        <div>
                            <h4>æ€»ä½“è´¨é‡åˆ†æ•°</h4>
                            <p>è´¨é‡ç­‰çº§ï¼š${validation.qualityLevel}</p>
                        </div>
                    </div>
                    
                    <div class="quality-details">
                        <div class="detail-item">
                            <div class="detail-value">${validation.actualPageCount}</div>
                            <div class="detail-label">PDFé¡µæ•°</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-value">${Math.round(validation.textSimilarity * 100)}%</div>
                            <div class="detail-label">æ–‡æœ¬ç›¸ä¼¼åº¦</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-value">${Math.round(validation.chineseCharacterAccuracy * 100)}%</div>
                            <div class="detail-label">ä¸­æ–‡å‡†ç¡®åº¦</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-value">${validation.structureIntact ? 'âœ…' : 'âŒ'}</div>
                            <div class="detail-label">ç»“æ„å®Œæ•´</div>
                        </div>
                    </div>
                    
                    ${validation.issues && validation.issues.length > 0 ? `
                        <div style="margin-top: 20px;">
                            <h4>âš ï¸ å‘ç°çš„é—®é¢˜ï¼š</h4>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                ${validation.issues.map(issue => `<li>${issue}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                    
                    ${data.conversion && data.conversion.downloadUrl ? `
                        <div style="margin-top: 20px; text-align: center;">
                            <a href="${data.conversion.downloadUrl}" 
                               style="background: #4facfe; color: white; padding: 12px 24px; 
                                      text-decoration: none; border-radius: 8px; display: inline-block;">
                                ğŸ“¥ ä¸‹è½½PDFæ–‡ä»¶
                            </a>
                        </div>
                    ` : ''}
                </div>
            `;
            
            resultDiv.innerHTML = html;
            resultDiv.style.display = 'block';
        }

        // æ˜¾ç¤ºæ‰¹é‡å¯¹æ¯”ç»“æœ
        function showComparisonResult(data) {
            const resultDiv = document.getElementById('result');
            const ranking = data.ranking || [];
            const summary = data.summary || {};
            
            const html = `
                <div class="quality-result">
                    <h3>ğŸ† è´¨é‡å¯¹æ¯”åˆ†æç»“æœ</h3>
                    
                    ${summary.recommendedConverter ? `
                        <div class="quality-score">
                            <div class="score-circle score-excellent">
                                ğŸ‘‘
                            </div>
                            <div>
                                <h4>æ¨èè½¬æ¢å™¨ï¼š${summary.recommendedConverter}</h4>
                                <p>æœ€ä½³åˆ†æ•°ï¼š${Math.round(summary.bestScore * 100)}% (${summary.bestLevel})</p>
                                <p>å¹³å‡åˆ†æ•°ï¼š${Math.round(summary.averageScore * 100)}%</p>
                            </div>
                        </div>
                    ` : ''}
                    
                    <table class="ranking-table">
                        <thead>
                            <tr>
                                <th>æ’å</th>
                                <th>è½¬æ¢å™¨</th>
                                <th>è´¨é‡åˆ†æ•°</th>
                                <th>è´¨é‡ç­‰çº§</th>
                                <th>é¡µæ•°å‡†ç¡®</th>
                                <th>æ–‡æœ¬ç›¸ä¼¼åº¦</th>
                                <th>ä¸­æ–‡å‡†ç¡®åº¦</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${ranking.map((item, index) => `
                                <tr>
                                    <td>${index + 1}</td>
                                    <td><strong>${item.converter}</strong></td>
                                    <td>${Math.round(item.score * 100)}%</td>
                                    <td>${item.level}</td>
                                    <td>${item.pageCountAccurate ? 'âœ…' : 'âŒ'}</td>
                                    <td>${Math.round(item.textSimilarity * 100)}%</td>
                                    <td>${Math.round(item.chineseAccuracy * 100)}%</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    
                    <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <h4>ğŸ“‹ è¯¦ç»†ç»“æœæ•°æ®</h4>
                        <pre style="font-size: 0.9rem; max-height: 300px; overflow-y: auto;">${JSON.stringify(data.results, null, 2)}</pre>
                    </div>
                </div>
            `;
            
            resultDiv.innerHTML = html;
            resultDiv.style.display = 'block';
        }

        // è½¬æ¢å¹¶éªŒè¯
        function convertAndValidate(converter) {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªWordæ–‡æ¡£');
                return;
            }
            
            showLoading();
            
            const formData = new FormData();
            formData.append('file', file);
            
            fetch(`/api/convert/convert-and-validate/${converter}`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                showResult(data, !data.error);
            })
            .catch(error => {
                showResult({error: error.message}, false);
            });
        }

        // è´¨é‡éªŒè¯
        function validateQuality() {
            const wordFile = document.getElementById('wordFileInput').files[0];
            const pdfFile = document.getElementById('pdfFileInput').files[0];
            const converter = document.getElementById('converterSelect').value;
            
            if (!wordFile || !pdfFile) {
                alert('è¯·é€‰æ‹©Wordæ–‡æ¡£å’ŒPDFæ–‡ä»¶');
                return;
            }
            
            showLoading();
            
            const formData = new FormData();
            formData.append('wordFile', wordFile);
            formData.append('pdfFile', pdfFile);
            formData.append('converterName', converter);
            
            fetch('/api/convert/validate-quality', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                showResult({validation: data}, !data.error);
            })
            .catch(error => {
                showResult({error: error.message}, false);
            });
        }

        // æ‰¹é‡è´¨é‡å¯¹æ¯”
        function batchQualityComparison() {
            const fileInput = document.getElementById('fileInput') || document.getElementById('compareFileInput');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªWordæ–‡æ¡£');
                return;
            }
            
            showLoading();
            
            const formData = new FormData();
            formData.append('file', file);
            
            fetch('/api/convert/quality-comparison', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                showResult(data, !data.error);
            })
            .catch(error => {
                showResult({error: error.message}, false);
            });
        }

        // ç®€å•è½¬æ¢ï¼ˆå…¼å®¹åŸæœ‰åŠŸèƒ½ï¼‰
        function convert(converter) {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªWordæ–‡æ¡£');
                return;
            }
            
            showLoading();
            
            const formData = new FormData();
            formData.append('file', file);
            
            fetch(`/api/convert/${converter}`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                showResult(data, data.success);
            })
            .catch(error => {
                showResult({error: error.message}, false);
            });
        }

        // JODConverter è½¬æ¢
        function convertWithJODConverter() {
            const fileInput = document.getElementById('fileInput') || document.getElementById('jodFileInput');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªWordæ–‡æ¡£');
                return;
            }
            
            showLoading();
            
            const formData = new FormData();
            formData.append('file', file);
            
            fetch('/api/jodconverter/convert', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    // JODConverter è¿”å›çš„æ˜¯PDFæ–‡ä»¶æµ
                    return response.blob().then(blob => {
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `jodconverter_${new Date().getTime()}.pdf`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        window.URL.revokeObjectURL(url);
                        
                        // æ˜¾ç¤ºæˆåŠŸä¿¡æ¯
                        const conversionTime = response.headers.get('X-Conversion-Time');
                        const fileSize = response.headers.get('X-File-Size');
                        
                        return {
                            success: true,
                            converter: 'JODConverter',
                            message: 'PDFæ–‡ä»¶å·²è‡ªåŠ¨ä¸‹è½½',
                            conversionTime: conversionTime ? `${conversionTime}ms` : 'æœªçŸ¥',
                            fileSize: fileSize ? `${Math.round(fileSize/1024)}KB` : 'æœªçŸ¥'
                        };
                    });
                } else {
                    return response.json().then(error => {
                        throw new Error(error.error || 'JODConverter è½¬æ¢å¤±è´¥');
                    });
                }
            })
            .then(data => {
                showResult(data, data.success);
            })
            .catch(error => {
                showResult({error: error.message}, false);
            });
        }

        // JODConverter è½¬æ¢å¹¶éªŒè¯è´¨é‡
        function convertAndValidateJOD() {
            const fileInput = document.getElementById('jodFileInput');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªWordæ–‡æ¡£');
                return;
            }
            
            showLoading();
            
            const formData = new FormData();
            formData.append('file', file);
            
            fetch('/api/convert/convert-and-validate/JODConverter', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                showResult(data, !data.error);
            })
            .catch(error => {
                showResult({error: error.message}, false);
            });
        }

        // æ£€æŸ¥ JODConverter çŠ¶æ€
        function checkJODConverterStatus() {
            fetch('/api/jodconverter/status')
                .then(response => response.json())
                .then(data => {
                    showJODStatus(data, 'status');
                })
                .catch(error => {
                    showJODStatus({error: error.message, available: false}, 'status');
                });
        }

        // æ£€æŸ¥ JODConverter å¥åº·çŠ¶æ€
        function checkJODConverterHealth() {
            fetch('/api/jodconverter/health')
                .then(response => response.json())
                .then(data => {
                    showJODStatus(data, 'health');
                })
                .catch(error => {
                    showJODStatus({error: error.message, status: 'DOWN'}, 'health');
                });
        }

        // æ˜¾ç¤º JODConverter çŠ¶æ€ç»“æœ
        function showJODStatus(data, type) {
            const resultDiv = document.getElementById('jodStatusResult');
            
            let html = '';
            if (type === 'status') {
                const statusIcon = data.available ? 'âœ…' : 'âŒ';
                const statusText = data.available ? 'å¯ç”¨' : 'ä¸å¯ç”¨';
                const statusColor = data.available ? '#28a745' : '#dc3545';
                
                html = `
                    <h4>ğŸ“Š JODConverter çŠ¶æ€æ£€æŸ¥</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-top: 10px;">
                        <div style="background: white; padding: 10px; border-radius: 5px; text-align: center;">
                            <div style="font-size: 1.5rem;">${statusIcon}</div>
                            <div style="color: ${statusColor}; font-weight: bold;">${statusText}</div>
                        </div>
                        <div style="background: white; padding: 10px; border-radius: 5px; text-align: center;">
                            <div style="font-weight: bold;">${data.converterName || 'JODConverter'}</div>
                            <div style="font-size: 0.9rem; color: #666;">è½¬æ¢å™¨åç§°</div>
                        </div>
                        <div style="background: white; padding: 10px; border-radius: 5px; text-align: center;">
                            <div style="font-weight: bold;">${data.timestamp || new Date().toLocaleString()}</div>
                            <div style="font-size: 0.9rem; color: #666;">æ£€æŸ¥æ—¶é—´</div>
                        </div>
                    </div>
                `;
            } else if (type === 'health') {
                const statusIcon = data.status === 'UP' ? 'ğŸ’š' : 'ğŸ’”';
                const statusColor = data.status === 'UP' ? '#28a745' : '#dc3545';
                
                html = `
                    <h4>â¤ï¸ JODConverter å¥åº·æ£€æŸ¥</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-top: 10px;">
                        <div style="background: white; padding: 10px; border-radius: 5px; text-align: center;">
                            <div style="font-size: 1.5rem;">${statusIcon}</div>
                            <div style="color: ${statusColor}; font-weight: bold;">${data.status}</div>
                        </div>
                        <div style="background: white; padding: 10px; border-radius: 5px;">
                            <div style="font-weight: bold;">æ¶ˆæ¯</div>
                            <div style="font-size: 0.9rem; color: #666;">${data.message || data.error || 'æ— '}</div>
                        </div>
                    </div>
                `;
            }
            
            if (data.error) {
                html += `<div style="background: #f8d7da; color: #721c24; padding: 10px; border-radius: 5px; margin-top: 10px;">
                    <strong>é”™è¯¯:</strong> ${data.error}
                </div>`;
            }
            
                         resultDiv.innerHTML = html;
             resultDiv.style.display = 'block';
         }

         // æµ‹è¯• JODConverter æ‰€æœ‰ç«¯ç‚¹
         function testJODConverterEndpoints() {
             showLoading();
             
             const tests = [
                 { name: 'å¥åº·æ£€æŸ¥', url: '/api/jodconverter/health', method: 'GET' },
                 { name: 'çŠ¶æ€æ£€æŸ¥', url: '/api/jodconverter/status', method: 'GET' },
                 { name: 'å¯ç”¨è½¬æ¢å™¨', url: '/api/convert/converters', method: 'GET' }
             ];
             
             Promise.all(tests.map(test => 
                 fetch(test.url)
                     .then(response => response.json())
                     .then(data => ({ test: test.name, success: true, data }))
                     .catch(error => ({ test: test.name, success: false, error: error.message }))
             ))
             .then(results => {
                 const html = `
                     <div class="quality-result">
                         <h3>ğŸ§ª JODConverter API ç«¯ç‚¹æµ‹è¯•ç»“æœ</h3>
                         <table class="ranking-table">
                             <thead>
                                 <tr>
                                     <th>æµ‹è¯•é¡¹ç›®</th>
                                     <th>çŠ¶æ€</th>
                                     <th>ç»“æœ</th>
                                 </tr>
                             </thead>
                             <tbody>
                                 ${results.map(result => `
                                     <tr>
                                         <td><strong>${result.test}</strong></td>
                                         <td>${result.success ? 'âœ… æˆåŠŸ' : 'âŒ å¤±è´¥'}</td>
                                         <td style="max-width: 300px; overflow: hidden;">
                                             ${result.success ? 
                                                 JSON.stringify(result.data, null, 2) : 
                                                 result.error
                                             }
                                         </td>
                                     </tr>
                                 `).join('')}
                             </tbody>
                         </table>
                     </div>
                 `;
                 
                 document.getElementById('result').innerHTML = html;
                 document.getElementById('result').style.display = 'block';
                 hideLoading();
             });
         }

         // æ€§èƒ½æµ‹è¯•
         function performanceTest() {
             const fileInput = document.getElementById('jodFileInput');
             const file = fileInput.files[0];
             
             if (!file) {
                 alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªWordæ–‡æ¡£è¿›è¡Œæ€§èƒ½æµ‹è¯•');
                 return;
             }
             
             showLoading();
             
             const startTime = Date.now();
             
             const formData = new FormData();
             formData.append('file', file);
             
             fetch('/api/jodconverter/convert', {
                 method: 'POST',
                 body: formData
             })
             .then(response => {
                 const endTime = Date.now();
                 const totalTime = endTime - startTime;
                 const conversionTime = response.headers.get('X-Conversion-Time');
                 const fileSize = response.headers.get('X-File-Size');
                 const converter = response.headers.get('X-Converter');
                 
                 if (response.ok) {
                     return response.blob().then(blob => ({
                         success: true,
                         totalTime,
                         conversionTime,
                         fileSize,
                         converter,
                         pdfSize: blob.size,
                         originalSize: file.size
                     }));
                 } else {
                     throw new Error('è½¬æ¢å¤±è´¥');
                 }
             })
             .then(data => {
                 const html = `
                     <div class="quality-result">
                         <h3>â±ï¸ JODConverter æ€§èƒ½æµ‹è¯•ç»“æœ</h3>
                         <div class="quality-details">
                             <div class="detail-item">
                                 <div class="detail-value">${data.totalTime}ms</div>
                                 <div class="detail-label">æ€»è€—æ—¶</div>
                             </div>
                             <div class="detail-item">
                                 <div class="detail-value">${data.conversionTime || 'æœªçŸ¥'}ms</div>
                                 <div class="detail-label">è½¬æ¢è€—æ—¶</div>
                             </div>
                             <div class="detail-item">
                                 <div class="detail-value">${Math.round(data.originalSize/1024)}KB</div>
                                 <div class="detail-label">åŸæ–‡ä»¶å¤§å°</div>
                             </div>
                             <div class="detail-item">
                                 <div class="detail-value">${Math.round(data.pdfSize/1024)}KB</div>
                                 <div class="detail-label">PDFå¤§å°</div>
                             </div>
                             <div class="detail-item">
                                 <div class="detail-value">${((data.originalSize/1024) / (data.totalTime/1000)).toFixed(2)}</div>
                                 <div class="detail-label">å¤„ç†é€Ÿåº¦ (KB/s)</div>
                             </div>
                             <div class="detail-item">
                                 <div class="detail-value">${data.converter || 'JODConverter'}</div>
                                 <div class="detail-label">è½¬æ¢å™¨</div>
                             </div>
                         </div>
                         
                         <div style="margin-top: 20px; padding: 15px; background: #d4edda; border-radius: 8px;">
                             <h4>âœ… æ€§èƒ½è¯„ä¼°</h4>
                             <p><strong>è½¬æ¢æ•ˆç‡:</strong> ${data.totalTime < 5000 ? 'ä¼˜ç§€' : data.totalTime < 10000 ? 'è‰¯å¥½' : 'ä¸€èˆ¬'}</p>
                             <p><strong>æ–‡ä»¶å‹ç¼©æ¯”:</strong> ${(data.pdfSize / data.originalSize * 100).toFixed(1)}%</p>
                             <p><strong>å¹³å‡å¤„ç†é€Ÿåº¦:</strong> ${((data.originalSize/1024) / (data.totalTime/1000)).toFixed(2)} KB/s</p>
                         </div>
                     </div>
                 `;
                 
                 document.getElementById('result').innerHTML = html;
                 document.getElementById('result').style.display = 'block';
                 hideLoading();
             })
             .catch(error => {
                 showResult({error: error.message}, false);
             });
         }

         // æ˜¾ç¤º JODConverter è¯¦ç»†ä¿¡æ¯
         function showJODConverterInfo() {
             showLoading();
             
             Promise.all([
                 fetch('/api/jodconverter/status').then(r => r.json()),
                 fetch('/api/jodconverter/health').then(r => r.json()),
                 fetch('/api/convert/converters').then(r => r.json())
             ])
             .then(([status, health, converters]) => {
                 const html = `
                     <div class="quality-result">
                         <h3>ğŸ“Š JODConverter è¯¦ç»†ä¿¡æ¯</h3>
                         
                         <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                             <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                 <h4>ğŸ”§ æœåŠ¡çŠ¶æ€</h4>
                                 <p><strong>å¯ç”¨æ€§:</strong> ${status.available ? 'âœ… å¯ç”¨' : 'âŒ ä¸å¯ç”¨'}</p>
                                 <p><strong>è½¬æ¢å™¨åç§°:</strong> ${status.converterName || 'JODConverter'}</p>
                                 <p><strong>æ£€æŸ¥æ—¶é—´:</strong> ${status.timestamp || new Date().toLocaleString()}</p>
                             </div>
                             
                             <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                 <h4>â¤ï¸ å¥åº·çŠ¶æ€</h4>
                                 <p><strong>çŠ¶æ€:</strong> ${health.status === 'UP' ? 'ğŸŸ¢ UP' : 'ğŸ”´ DOWN'}</p>
                                 <p><strong>æ¶ˆæ¯:</strong> ${health.message || health.error || 'æ­£å¸¸'}</p>
                                 <p><strong>æœåŠ¡ç±»å‹:</strong> ä¼ä¸šçº§æ–‡æ¡£è½¬æ¢</p>
                             </div>
                             
                             <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                 <h4>ğŸ“‹ è½¬æ¢å™¨åˆ—è¡¨</h4>
                                 <p><strong>å¯ç”¨è½¬æ¢å™¨:</strong></p>
                                 <ul style="margin-left: 20px;">
                                     ${converters.map(c => `<li>${c}${c === 'JODConverter' ? ' ğŸŒŸ' : ''}</li>`).join('')}
                                 </ul>
                             </div>
                         </div>
                         
                         <div style="margin-top: 20px; padding: 15px; background: #e7f3ff; border-radius: 8px;">
                             <h4>ğŸ“ˆ JODConverter æŠ€æœ¯è§„æ ¼</h4>
                             <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 10px;">
                                 <div><strong>æ¶æ„:</strong> LibreOffice UNO API</div>
                                 <div><strong>è¿›ç¨‹ç®¡ç†:</strong> è¿æ¥æ± æ¨¡å¼</div>
                                 <div><strong>å¹¶å‘æ”¯æŒ:</strong> å¤šè¿›ç¨‹æ± </div>
                                 <div><strong>æ–‡æ¡£æ ¼å¼:</strong> DOC, DOCX â†’ PDF</div>
                                 <div><strong>å­—ç¬¦ç¼–ç :</strong> UTF-8 å®Œæ•´æ”¯æŒ</div>
                                 <div><strong>éƒ¨ç½²æ¨¡å¼:</strong> Spring Boot é›†æˆ</div>
                             </div>
                         </div>
                     </div>
                 `;
                 
                 document.getElementById('result').innerHTML = html;
                 document.getElementById('result').style.display = 'block';
                 hideLoading();
             })
             .catch(error => {
                 showResult({error: 'è·å–ä¿¡æ¯å¤±è´¥: ' + error.message}, false);
             });
         }

         // å¯¹è±¡å­˜å‚¨è½¬æ¢
         function convertToStorage() {
             const fileInput = document.getElementById('fileInput') || document.getElementById('jodFileInput');
             const file = fileInput.files[0];
             
             if (!file) {
                 alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªWordæ–‡æ¡£');
                 return;
             }
             
             showLoading();
             
             const formData = new FormData();
             formData.append('file', file);
             
             fetch('/api/jodconverter/convert-to-storage', {
                 method: 'POST',
                 body: formData
             })
             .then(response => response.json())
             .then(data => {
                 showResult(data, data.success);
             })
             .catch(error => {
                 showResult({error: error.message}, false);
             });
         }

         // æ˜¾ç¤ºå¯¹è±¡å­˜å‚¨ç»“æœ
         function showStorageResult(data) {
             const resultDiv = document.getElementById('result');
             
             if (!data.success) {
                 resultDiv.innerHTML = `
                     <div style="background: #f8d7da; color: #721c24; padding: 20px; border-radius: 10px;">
                         <h4>âŒ è½¬æ¢å¤±è´¥</h4>
                         <p><strong>é”™è¯¯ä¿¡æ¯:</strong> ${data.error || data.message}</p>
                         <pre style="margin-top: 10px; background: white; padding: 10px; border-radius: 5px;">${JSON.stringify(data, null, 2)}</pre>
                     </div>
                 `;
                 resultDiv.style.display = 'block';
                 return;
             }
             
             const html = `
                 <div class="quality-result">
                     <h3>â˜ï¸ å¯¹è±¡å­˜å‚¨è½¬æ¢æˆåŠŸ</h3>
                     
                     <div class="quality-score">
                         <div class="score-circle score-excellent">
                             âœ…
                         </div>
                         <div>
                             <h4>è½¬æ¢å®Œæˆå¹¶å·²ä¸Šä¼ åˆ°å¯¹è±¡å­˜å‚¨</h4>
                             <p>æ–‡ä»¶: ${data.originalFileName}</p>
                             <p>å­˜å‚¨æ¡¶: ${data.bucketName}</p>
                         </div>
                     </div>
                     
                     <div class="quality-details">
                         <div class="detail-item">
                             <div class="detail-value">${data.fileSizeFormatted || Math.round(data.fileSize/1024) + 'KB'}</div>
                             <div class="detail-label">æ–‡ä»¶å¤§å°</div>
                         </div>
                         <div class="detail-item">
                             <div class="detail-value">${data.conversionTimeFormatted || data.conversionTime + 'ms'}</div>
                             <div class="detail-label">è½¬æ¢æ—¶é—´</div>
                         </div>
                         <div class="detail-item">
                             <div class="detail-value">${data.totalTimeFormatted || data.totalTime + 'ms'}</div>
                             <div class="detail-label">æ€»è€—æ—¶</div>
                         </div>
                         <div class="detail-item">
                             <div class="detail-value">${data.converter}</div>
                             <div class="detail-label">è½¬æ¢å™¨</div>
                         </div>
                     </div>
                     
                     <div style="margin-top: 20px; padding: 20px; background: #d4edda; border-radius: 10px;">
                         <h4>ğŸ”— ä¸‹è½½é“¾æ¥</h4>
                         <div style="margin: 15px 0;">
                             <p><strong>æ°¸ä¹…ä¸‹è½½é“¾æ¥:</strong></p>
                             <div style="background: white; padding: 10px; border-radius: 5px; margin: 5px 0; word-break: break-all; font-family: monospace; font-size: 0.9rem;">
                                 ${data.downloadUrl}
                             </div>
                             <button onclick="window.open('${data.downloadUrl}', '_blank')" 
                                     style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-right: 10px;">
                                 ğŸ“¥ ç›´æ¥ä¸‹è½½
                             </button>
                             <button onclick="testDownloadUrl('${data.downloadUrl}')" 
                                     style="background: #17a2b8; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-right: 10px;">
                                 ğŸ” æµ‹è¯•é“¾æ¥
                             </button>
                             <button onclick="copyToClipboard('${data.downloadUrl}')" 
                                     style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">
                                 ğŸ“‹ å¤åˆ¶é“¾æ¥
                             </button>
                         </div>
                         
                         ${data.preSignedUrl ? `
                             <div style="margin: 15px 0;">
                                 <p><strong>é¢„ç­¾åé“¾æ¥ (${data.preSignedUrlExpiration}):</strong></p>
                                 <div style="background: white; padding: 10px; border-radius: 5px; margin: 5px 0; word-break: break-all; font-family: monospace; font-size: 0.9rem;">
                                     ${data.preSignedUrl}
                                 </div>
                                 <button onclick="window.open('${data.preSignedUrl}', '_blank')" 
                                         style="background: #fd7e14; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-right: 10px;">
                                     ğŸ“¥ é€šè¿‡é¢„ç­¾åä¸‹è½½
                                 </button>
                                 <button onclick="copyToClipboard('${data.preSignedUrl}')" 
                                         style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">
                                     ğŸ“‹ å¤åˆ¶é¢„ç­¾åé“¾æ¥
                                 </button>
                             </div>
                         ` : ''}
                     </div>
                     
                     <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                         <h4>ğŸ“ å­˜å‚¨ä¿¡æ¯</h4>
                         <p><strong>å¯¹è±¡é”®:</strong> <code>${data.objectKey}</code></p>
                         <p><strong>å­˜å‚¨æ¡¶:</strong> <code>${data.bucketName}</code></p>
                         <p><strong>è½¬æ¢æ—¶é—´:</strong> ${data.timestamp}</p>
                     </div>
                     
                     <div style="margin-top: 15px; padding: 10px; background: #e2e3e5; border-radius: 5px;">
                         <details>
                             <summary style="cursor: pointer; font-weight: bold;">ğŸ” æŸ¥çœ‹å®Œæ•´å“åº”æ•°æ®</summary>
                             <pre style="margin-top: 10px; background: white; padding: 10px; border-radius: 5px; overflow-x: auto; font-size: 0.8rem;">${JSON.stringify(data, null, 2)}</pre>
                         </details>
                     </div>
                 </div>
             `;
             
             resultDiv.innerHTML = html;
             resultDiv.style.display = 'block';
         }

         // æµ‹è¯•å­˜å‚¨è½¬æ¢ (ä½¿ç”¨é¢„è®¾æ–‡ä»¶)
         function testStorageConversion() {
             showLoading();
             
             // åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç”¨çš„æ–‡ä»¶å¯¹è±¡ (æ¨¡æ‹Ÿ)
             fetch('/api/jodconverter/test')
                 .then(response => response.json())
                 .then(testData => {
                     if (testData.status === 'OK') {
                         // å¦‚æœæœ‰æµ‹è¯•æ–‡ä»¶ï¼Œæç¤ºç”¨æˆ·é€‰æ‹©
                         const fileInput = document.getElementById('jodFileInput');
                         if (fileInput.files.length === 0) {
                             hideLoading();
                             alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªWordæ–‡æ¡£è¿›è¡Œæµ‹è¯•ï¼Œæˆ–ä½¿ç”¨"â˜ï¸ è½¬æ¢åˆ°å¯¹è±¡å­˜å‚¨"æŒ‰é’®');
                             return;
                         }
                         convertToStorage();
                     } else {
                         throw new Error('JODConverteræœåŠ¡ä¸å¯ç”¨');
                     }
                 })
                 .catch(error => {
                     hideLoading();
                     showResult({error: 'JODConverteræœåŠ¡æ£€æŸ¥å¤±è´¥: ' + error.message}, false);
                 });
         }

         // æµ‹è¯•ä¸‹è½½é“¾æ¥
         function testDownloadLinks() {
             const urlInput = prompt('è¯·è¾“å…¥è¦æµ‹è¯•çš„ä¸‹è½½é“¾æ¥URL:', 'http://localhost:8080/api/download/');
             
             if (!urlInput) return;
             
             showLoading();
             
             fetch(urlInput, { method: 'HEAD' })
                 .then(response => {
                     const status = response.status;
                     const statusText = response.statusText;
                     const contentType = response.headers.get('Content-Type');
                     const contentLength = response.headers.get('Content-Length');
                     const contentDisposition = response.headers.get('Content-Disposition');
                     
                     const html = `
                         <div class="quality-result">
                             <h3>ğŸ”— ä¸‹è½½é“¾æ¥æµ‹è¯•ç»“æœ</h3>
                             
                             <div class="quality-score">
                                 <div class="score-circle ${status === 200 ? 'score-excellent' : 'score-poor'}">
                                     ${status === 200 ? 'âœ…' : 'âŒ'}
                                 </div>
                                 <div>
                                     <h4>HTTPçŠ¶æ€: ${status} ${statusText}</h4>
                                     <p>é“¾æ¥: ${urlInput}</p>
                                 </div>
                             </div>
                             
                             <div class="quality-details">
                                 <div class="detail-item">
                                     <div class="detail-value">${status}</div>
                                     <div class="detail-label">HTTPçŠ¶æ€ç </div>
                                 </div>
                                 <div class="detail-item">
                                     <div class="detail-value">${contentType || 'æœªçŸ¥'}</div>
                                     <div class="detail-label">æ–‡ä»¶ç±»å‹</div>
                                 </div>
                                 <div class="detail-item">
                                     <div class="detail-value">${contentLength ? Math.round(contentLength/1024) + 'KB' : 'æœªçŸ¥'}</div>
                                     <div class="detail-label">æ–‡ä»¶å¤§å°</div>
                                 </div>
                                 <div class="detail-item">
                                     <div class="detail-value">${status === 200 ? 'å¯ç”¨' : 'ä¸å¯ç”¨'}</div>
                                     <div class="detail-label">é“¾æ¥çŠ¶æ€</div>
                                 </div>
                             </div>
                             
                             ${contentDisposition ? `
                                 <div style="margin-top: 15px; padding: 10px; background: #e7f3ff; border-radius: 5px;">
                                     <p><strong>Content-Disposition:</strong> <code>${contentDisposition}</code></p>
                                 </div>
                             ` : ''}
                             
                             ${status === 200 ? `
                                 <div style="margin-top: 15px; text-align: center;">
                                     <button onclick="window.open('${urlInput}', '_blank')" 
                                             style="background: #28a745; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                                         ğŸ“¥ ä¸‹è½½æ–‡ä»¶
                                     </button>
                                 </div>
                             ` : ''}
                         </div>
                     `;
                     
                     document.getElementById('result').innerHTML = html;
                     document.getElementById('result').style.display = 'block';
                     hideLoading();
                 })
                 .catch(error => {
                     showResult({error: 'é“¾æ¥æµ‹è¯•å¤±è´¥: ' + error.message}, false);
                 });
         }

         // æµ‹è¯•å•ä¸ªä¸‹è½½URL
         function testDownloadUrl(url) {
             fetch(url, { method: 'HEAD' })
                 .then(response => {
                     const status = response.status;
                     if (status === 200) {
                         alert(`âœ… é“¾æ¥æœ‰æ•ˆï¼\nçŠ¶æ€: ${status}\nç±»å‹: ${response.headers.get('Content-Type')}\nå¤§å°: ${Math.round(response.headers.get('Content-Length')/1024)}KB`);
                     } else {
                         alert(`âŒ é“¾æ¥æ— æ•ˆï¼\nçŠ¶æ€: ${status} ${response.statusText}`);
                     }
                 })
                 .catch(error => {
                     alert(`âŒ æµ‹è¯•å¤±è´¥: ${error.message}`);
                 });
         }

         // æ˜¾ç¤ºå­˜å‚¨ä¿¡æ¯
         function showStorageInfo() {
             showLoading();
             
             // è·å–å¤šä¸ªç›¸å…³ä¿¡æ¯
             Promise.all([
                 fetch('/api/jodconverter/status').then(r => r.json()).catch(() => ({})),
                 // å¯ä»¥æ·»åŠ æ›´å¤šå­˜å‚¨ç›¸å…³çš„APIè°ƒç”¨
             ])
             .then(([jodStatus]) => {
                 const html = `
                     <div class="quality-result">
                         <h3>ğŸ“ å¯¹è±¡å­˜å‚¨çŠ¶æ€ä¿¡æ¯</h3>
                         
                         <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                             <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                 <h4>ğŸ”§ JODConverterçŠ¶æ€</h4>
                                 <p><strong>æœåŠ¡çŠ¶æ€:</strong> ${jodStatus.available ? 'âœ… å¯ç”¨' : 'âŒ ä¸å¯ç”¨'}</p>
                                 <p><strong>è½¬æ¢å™¨:</strong> ${jodStatus.converterName || 'JODConverter'}</p>
                                 <p><strong>æ£€æŸ¥æ—¶é—´:</strong> ${jodStatus.timestamp || new Date().toLocaleString()}</p>
                             </div>
                             
                             <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                 <h4>ğŸ’¾ å­˜å‚¨é…ç½®</h4>
                                 <p><strong>å­˜å‚¨ç±»å‹:</strong> Mockå¯¹è±¡å­˜å‚¨</p>
                                 <p><strong>å­˜å‚¨è·¯å¾„:</strong> /tmp/word2pdf/storage</p>
                                 <p><strong>ä¸‹è½½åŸºURL:</strong> http://localhost:8080/api/download</p>
                                 <p><strong>å­˜å‚¨æ¡¶:</strong> word2pdf-bucket</p>
                             </div>
                             
                             <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                 <h4>ğŸŒ APIæ¥å£</h4>
                                 <p><strong>å¯¹è±¡å­˜å‚¨è½¬æ¢:</strong> POST /api/jodconverter/convert-to-storage</p>
                                 <p><strong>æ–‡ä»¶ä¸‹è½½:</strong> GET /api/download/**</p>
                                 <p><strong>å¥åº·æ£€æŸ¥:</strong> GET /api/jodconverter/health</p>
                                 <p><strong>çŠ¶æ€æŸ¥è¯¢:</strong> GET /api/jodconverter/status</p>
                             </div>
                         </div>
                         
                         <div style="margin-top: 20px; padding: 20px; background: #e7f3ff; border-radius: 10px;">
                             <h4>ğŸ“‹ ä½¿ç”¨è¯´æ˜</h4>
                             <ol style="margin-left: 20px;">
                                 <li>é€‰æ‹©Wordæ–‡æ¡£(.docxæˆ–.docæ ¼å¼)</li>
                                 <li>ç‚¹å‡»"â˜ï¸ è½¬æ¢åˆ°å¯¹è±¡å­˜å‚¨"æŒ‰é’®</li>
                                 <li>ç­‰å¾…è½¬æ¢å®Œæˆï¼Œè·å¾—ä¸‹è½½é“¾æ¥</li>
                                 <li>ä½¿ç”¨ä¸‹è½½é“¾æ¥è®¿é—®PDFæ–‡ä»¶</li>
                                 <li>é“¾æ¥æ”¯æŒç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æˆ–ä¸‹è½½</li>
                             </ol>
                         </div>
                         
                         <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 8px;">
                             <h4>âš¡ å¿«é€Ÿæ“ä½œ</h4>
                             <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px;">
                                 <button onclick="testJODConverterEndpoints()" style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">
                                     æµ‹è¯•APIç«¯ç‚¹
                                 </button>
                                 <button onclick="testDownloadLinks()" style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">
                                     æµ‹è¯•ä¸‹è½½é“¾æ¥
                                 </button>
                                 <button onclick="convertToStorage()" style="background: #fd79a8; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">
                                     å¼€å§‹è½¬æ¢
                                 </button>
                             </div>
                         </div>
                     </div>
                 `;
                 
                 document.getElementById('result').innerHTML = html;
                 document.getElementById('result').style.display = 'block';
                 hideLoading();
             })
             .catch(error => {
                 showResult({error: 'è·å–å­˜å‚¨ä¿¡æ¯å¤±è´¥: ' + error.message}, false);
             });
         }

         // å¤åˆ¶åˆ°å‰ªè´´æ¿
         function copyToClipboard(text) {
             navigator.clipboard.writeText(text).then(function() {
                 alert('âœ… é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
             }, function(err) {
                 // é™çº§æ–¹æ¡ˆ
                 const textArea = document.createElement('textarea');
                 textArea.value = text;
                 document.body.appendChild(textArea);
                 textArea.select();
                 try {
                     document.execCommand('copy');
                     alert('âœ… é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                 } catch (err) {
                     alert('âŒ å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶é“¾æ¥');
                 }
                 document.body.removeChild(textArea);
             });
         }
    </script>
</body>
</html> 